
# TopologyProject: Computational Topological Analysis of PFRC Plasma Data

This repository contains code, scripts, and documentation for performing computational topological analysis on plasma diagnostic data from the Princeton Field Reversal Configuration (PFRC) Experiment. Our goal is to extract and study the intrinsic “shape” of plasma pressure data using techniques from topological data analysis (TDA).

## Project Overview

The PFRC experiment at PPPL collects diagnostic data on plasma behavior in a field-reversed configuration. This repository focuses on the pressure data collected during these experiments. The pressure data are stored as `.trc` files, which are binary files generated by Lecroy oscilloscopes. We use the `lecroyparser` package to read these files and extract time-series data. From these data, we aim to construct point clouds and use persistent homology to analyze the connectivity and dynamics of the plasma over time.

## Directory Structure

The repository is organized as follows:

```
TopologyProject/
├── Data/
│   ├── raw/                
│   │   └── pfrc/20200309/pressure/  
│   │       ├── C1--pressure--00006.trc
│   │       ├── C1--pressure--01618.trc
│   │       ├── ... (other .trc files)
│   ├── stats/              
│   │   └── (CSV files with descriptive statistics for each .trc file)
│   └── README_data.md      # Documentation on the PFRC data files and file naming conventions
├── notebooks/
│   └── exploratory_analysis.ipynb   # (Optional) Jupyter Notebook version for interactive analysis
├── src/
│   └── exploratory_analysis.py       # Python script for processing and analyzing the .trc files
├── environment.yml         # Conda environment file with dependencies
├── README.md               # This file
└── LICENSE                 # License file (e.g., MIT License)
```

## Getting Started

### Prerequisites

- **Conda** (Miniconda or Anaconda)  
- Python 3.10  
- The following packages are included in our environment:
  - numpy, scipy, pandas, matplotlib, seaborn, scikit-learn
  - jupyterlab, ipython, jupyter
  - tqdm, h5py, pytables, xarray, netCDF4, dask, numba, cython
  - Additional pip packages: openpyxl, pyarrow, lxml, and lecroyparser

### Setting Up Your Environment

If you have an existing Conda environment named `my_analysis_env` and want to update it using our `environment.yml`, run:

```bash
conda env update --name my_analysis_env --file environment.yml --prune
conda activate my_analysis_env
```

If you’re creating a new environment, use:

```bash
conda env create -f environment.yml
conda activate my_analysis_env
```

### Data

- **Raw Data:**  
  The raw PFRC pressure data are located in `Data/raw/pfrc/20200309/pressure/`. These files are in the `.trc` format generated by Lecroy scopes.
  
- **Data Description:**  
  Each `.trc` file contains a pressure waveform captured during an experimental shot. The metadata (e.g., experimental conditions, diagnostic comments) is provided in a summary file (e.g., `20200309-summary.txt`) and a separate documentation file (`README_data.md`), which describe:
  - RF (rmf) parameters such as frequency and power.
  - Pressure diagnostic details, including individual traces, gas puff compensation, and averaged traces.
  - Information on other diagnostics (interferometer, X-rays, TALIF, spectrometer, etc.) for context, though this project currently focuses on pressure data.
  
- **Processed Data:**  
  Processed outputs (e.g., descriptive statistics) are saved under `Data/stats/`.

### Usage

#### 1. Running the Exploratory Analysis Script

The main script is located at `src/exploratory_analysis.py`. It performs the following:
- Lists all pressure `.trc` files.
- Uses `lecroyparser` to load each file and extract the waveform (amplitude) and time data.
- Converts the extracted data into a Pandas DataFrame.
- Plots a sample waveform.
- Computes and saves descriptive statistics for each file.

To run the script:

```bash
python src/exploratory_analysis.py
```

#### 2. (Optional) Using the Jupyter Notebook

If you prefer an interactive environment, open the notebook:

```bash
jupyter notebook notebooks/exploratory_analysis.ipynb
```

This notebook contains similar functionality as the script, along with interactive plots and additional exploratory analysis options.

### Understanding the PFRC Data

- **Pressure Data:**  
  Pressure data captures how the gas pressure inside the PFRC changes over time during an experimental shot. This includes dynamic changes due to gas puffing, RF power pulses, and other transient events. Analyzing these traces can reveal insights into plasma behavior and stability.

- **Diagnostic Context:**  
  The accompanying summary file and documentation describe the experiment's conditions, such as the operating frequency of the RF fields, gas type (H₂), and comments on how the pressure traces were recorded and processed. This context is critical for interpreting the topological features you will extract from the data.

- **Goal for Analysis:**  
  By constructing point clouds (or sliding windows) from the pressure time-series data, you can build simplicial complexes (e.g., via Vietoris–Rips complexes) and compute persistent homology. This topological analysis will help identify robust features (e.g., cycles, clusters) that may correlate with plasma instabilities or transitions in the experimental shots.

### Contributing

Contributions to improve the data processing, analysis scripts, or documentation are welcome! Please open an issue or submit a pull request with your suggestions.

### License

This project is licensed under the [MIT License](LICENSE).

### Contact

For questions, feedback, or collaboration, please contact [Your Name] at [your.email@example.com].

---

This README provides an updated and comprehensive overview of the project, the data, and the analysis pipeline. Feel free to modify any section to better match your project details or to add additional information as your work progresses.
